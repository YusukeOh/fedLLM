# Macroeconomic Forecasting with LLM speaking Fed's dialect

## 1. モチベーション

マクロ変数の予測におけるLLMの有用性、とりわけその「推論能力」の適用可能性を検討する。既存のTime-LLMのアプローチ（後述）に対し、ドメイン知識を陽に組み込む拡張を行うことで、以下の2点のリサーチ・クエスチョンに答える。

1. LLMに、Fedの景気判断を知識として与えることは、マクロ経済変数の予測精度の向上に寄与するか？
2. 数値の変動をFedの語彙で解釈させることで、予測の根拠をナラティブとして説明可能なモデル（Explainable AI）を構築できるか？

## 2. 先行研究の概観

LLMを時系列予測に用いる研究は、これまで、センチメント指標を作成して伝統的なARモデルなどに加えるアプローチが主流。

他方、近年ではLLMの推論能力自体を時系列予測に転用する **Time Series Foundation Models (TSFM)** の研究が急速に発展している。TSFMは、自然言語処理分野におけるLLMの成功と同様に、膨大な時系列データをベースに事前学習を行った汎用的な予測モデルを用意して、多種多様な予測に活用することを目指している。すでに気象や交通など、分野横断的に予測タスクで応用が進んでいる。

しかし、マクロ経済予測においては、たとえば、Carriero et al. (2025) が指摘するように、米国のデータを用いた比較においては、TSFMはVAR等の伝統的な計量経済モデルに比べて明確に優れているわけではないことが指摘されている。その背景として、経済変数の間には複雑な因果関係が働いており、汎用的なTSFMにはこのようなドメイン知識が欠けていることが挙げられた。

## 3. 本研究のアプローチ

本研究は、ICLR2024採択のJin et al. (2024)による **Time-LLM** をベースとする。Time-LLMでは、既存の学習済みLLMのパラメータを完全に固定したうえで、まず、LLMが理解できる語彙を使って時系列データをうまく変換する（**Reprogramming**）[^1]。次に、プロンプトに、データの定義や統計的特徴といった情報を加え、LLMに対する文脈的な補助情報として機能させる（**Prompt-as-Prefix**）。

## 4. 本研究の独自性

Time-LLMのフレームワークは、ドメイン知識を柔軟に組み込ませることを可能とする。本研究では、以下の2ステップで経済予測に向けたTime-LLMの拡張を目指す。

### ステップ1a〈基盤〉：Domain-Anchored Prompt-as-Prefix

オリジナルのTime-LLMのPrompt-as-Prefixは、データセットの一般的な説明と記述統計（min, max, median等）で構成されている。しかし記述統計はパッチ埋込みが既に伝える情報と重複する。一方、パッチからは推論できない情報——どの変数か、どのような変換が施されているか——が欠落している。

本研究では、プロンプトに変数名・経済的役割・変換の意味（例：「CPI All Items、ヘッドラインインフレ、Δ²logにより月次インフレ率の変化を表す」）を載せる。これにより、凍結LLMが事前学習で獲得した時代不変のドメイン知識（例：「インフレ加速時に金融政策はどう動くか」）を活性化する。

### ステップ1b〈試し打ち〉：FOMC声明文の注入

ステップ1aに加え、予測時点におけるFOMC声明文をプロンプトに注入し、Fedの景気判断が予測精度を改善するかを検証する。ただし、凍結LLMの事前学習コーパスには過去の経済的事実が含まれているため、FOMC声明文が時期を暗黙的に特定し、look-aheadバイアスの経路となりうる（後述）。

### ステップ2〈本研究の核心〉：Time-LLMをFedの語彙でReprogramming

オリジナルのTime-LLMでは、Reprogrammingの学習において、電力、天気など、様々な時系列データの動きを、一般的な語彙で表現した。これに対して、本研究では、マクロ経済に特化した語彙で表現することで、多変量時系列データによりシャープな経済学的な意味づけを与えることを試みる。

具体的には、Reprogrammingの学習に、米国のリアルタイム多変量時系列データ（FRED-MD）を用い、LLMの一般的な語彙ではなく、FOMC声明文や議事録で使われたことのある表現に制限する。これにより、例えば、CPIの上昇という現象に対して、同時に失業率の低下が観測されれば「需要過熱」というナラティブを、逆に生産の停滞が観測されれば「供給制約」というナラティブを抽出することが期待される。語彙埋込みは概念の意味を符号化するものであり、特定時期の事実ではないため、この手法のlook-aheadリスクは低い。

### Look-aheadバイアスへの対処

凍結LLMを予測に用いる場合、伝統的なデータ管理（リアルタイムヴィンテージの使用、FOMC文書の公開日管理）に加えて、**LLMの事前学習コーパス自体に埋め込まれた将来情報**への対処が不可欠である。特にステップ1bでは、FOMC声明文が時期の暗黙的な特定を可能にし、凍結LLMの「記憶」から未来の情報が漏洩する経路が生じうる。

本研究では以下の統制実験により、真の経済的推論とlook-aheadバイアスの分離を図る：

1. **時間的シャッフル検定**：FOMC声明文をランダムな予測時点に割り当て、時間的同定への依存度を測定
2. **LLM訓練打ち切り日の活用**：LLMの学習データ打ち切り日の前後で効果を分離評価
3. **GPT-2バックボーンによる検証**：学習打ち切りがより早い（~2019年末）GPT-2を用い、2020年以降のデータでlook-ahead-freeの効果を測定
4. **Fedマクロ経済モデルによる仮想データ検証**：LLMが学習していない仮想的な経済データで性能を確認

## 5. 予想される本研究の貢献

1. **手法上の貢献：** ドメイン知識を陽にLLMによる予測タスクに取り入れることで、LLMの推論能力がマクロ経済予測に有用であるかを検証する。特に、変数の経済的意味づけ（Domain-Anchored PaP）とFed語彙へのReprogramming制限が、汎用的なTime-LLMを超える精度を達成するかを明らかにする。
2. **経済ナラティブの可視化：** 数値データの背後にある経済ロジックを言語化[^2]することで、モデルは、入力データを「労働需給のひっ迫」や、「供給ショック」といった、Fedの語彙に関連付けて解釈する。これにより、ポリシーメーカーが直感的にその妥当性を検証することが可能な、「ナラティブのある予測」をリアルタイムで提供することができる。
3. **Look-aheadバイアスの定量的分離：** 凍結LLMの事前学習コーパスを経由するlook-aheadバイアスを定量化する枠組みを提案する。これは、LLMを時系列予測に用いる研究全般に適用可能な方法論的貢献である。

## 参考文献

- Carriero, A., Pettenuzzo, D. and Shekhar, S. (2025) 'Macroeconomic Forecasting with Large Language Models', arXiv preprint.
- Jin, M., Wang, S., Ma, L., Chu, Z., Zhang, J.Y., Shi, X., Chen, P.-Y., Liang, Y., Li, Y.-F., Pan, S. and Wen, Q. (2024) 'Time-LLM: Time Series Forecasting by Reprogramming Large Language Models', in *Proceedings of the ICLR 2024*.

[^1]: 具体的には、時系列データを、LLMがすでに内部に保持している単語の意味ベクトルの線形和として学習させる。これにより、時系列の局所的な動きが次々と「言語化」され（例えば、下落しているセグメント＝0.7×「安定」＋0.3×「下降」）時系列全体が一種の言語としてLLMに理解されるようになる。
[^2]: Time-LLMの元論文と同様に、アテンション・ウェイトを確認することで可視化を試みる。