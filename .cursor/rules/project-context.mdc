---
description: fedLLMプロジェクトの現在の状態・確定済み設計判断・進行中の議論
alwaysApply: true
---

# fedLLM プロジェクトコンテキスト

## プロジェクト概要

Time-LLM（Jin et al., 2024, ICLR）をベースに、FRBのドメイン知識（FOMC声明文・議事録の語彙）を組み込んだマクロ経済予測モデルを構築する。RQ1: Fedの景気判断は予測精度を向上させるか、RQ2: Fed語彙でExplainable AIを構築できるか。

## 現在のフェーズ

**フェーズ1（データ収集・前処理）完了。フェーズ2（Step 1実装）に進む準備が整った。**

### フェーズ1の完了成果物
- **FRED-MD前処理パイプライン実装済み** (src/data/fred_md.py): 変換前線形補間 → tcode変換 → 始期1978-02 → Winsorization(10×IQR) → StandardScaler。公表ステータスマスク生成対応
- **CES変数差替え済み**: CES0600000007 → CES0600000008（時間当たり賃金, tcode=6）
- **FOMC文書収集完了**: 244声明文 + 308議事録 (data/raw/fomc/)
- **Fed語彙辞書構築完了**: GPT-2トークナイザーで5,000トークン (data/vocabulary/fed_vocab_gpt2.json)
- **Domain-Anchored PaP実装済み** (src/data/prompt_dictionary.py, src/models/time_llm/model.py): 29変数すべてに変数名・経済的役割・変換意味のプロンプトを定義。統計ベースPaPを置換
- **時間軸アライメント実装済み** (src/data/temporal_alignment.py)

### 次のアクション（フェーズ2: Step 1実装）
- Step 1a: Domain-Anchored PaPでのベースライン学習・評価（FOMC声明文なし）
- Step 1b: FOMC声明文をPaPに追加した実験
- look-ahead統制実験の設計・実装

## 確定・暫定の設計判断（詳細は discussions/decisions.md）

- **バックボーンLLM** [tentative]: 本実験はLLaMA-3.1-8B（128k語彙）。再現実験はLLaMA-7B、デバッグはGPT-2（→ discussions/001_backbone_llm_selection.md）
- **変数選択** [confirmed]: FRED-MDコア29変数（9カテゴリ）。CES0600000008に差替え済み。全変数データ可用性検証済み（→ discussions/002_fred_md_variable_selection.md）
- **前処理パイプライン** [confirmed, **実装済み**]: 始期1978-02（575ヶ月）、変換前線形補間、tcode変換、Winsorization（10×IQR）、StandardScaler（→ discussions/003_preprocessing_pipeline.md）
- **[UNPUB]トークン** [tentative]: 末尾jagged edgesを学習可能な埋込みで処理。設計確定、layers.pyへの実装はPhase 2（→ discussions/003_preprocessing_pipeline.md）
- **PaP設計** [confirmed, **実装済み**]: Domain-Anchored PaP（変数名＋経済的役割＋変換意味）。29変数プロンプト辞書定義済み。統計・時期は除外（→ discussions/004_pap_design_and_lookahead.md, src/data/prompt_dictionary.py）
- **Look-ahead対策** [confirmed]: 時間的シャッフル検定、LLM打ち切り日テスト、GPT-2バックボーン検証、Fedモデル仮想データ検証の4手法（→ discussions/004_pap_design_and_lookahead.md）
- **LLMパラメータ**: 凍結。学習対象はReprogramming層とプロンプト関連のみ
- **データ**: FRED-MD（唯一の数値データソース）＋FOMC声明文・議事録

## 議論の管理

このプロジェクトでは、設計判断の議論を `discussions/` に蓄積している。新しいセッションを開始する際は、まず `discussions/decisions.md` を確認して最新の方針を把握すること。議論が発生した場合は `discussions/` に記録を残すこと（→ .cursor/rules/discussion-workflow.mdc）。
